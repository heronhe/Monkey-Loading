function MK_Extend(c,b){var a=function(){};a.prototype=b.prototype;c.prototype=new a();c.prototype.constructor=c;}function EventDispatcher(){this.registorPool={};
this.registorPoolvision="1.0";}EventDispatcher.prototype.addEventListener=function(f,c){var d=this;if(!d.registorPool[f]){d.registorPool[f]=new Array();
}var b=d.registorPool[f];var a=false;for(var e=0,g=b.length;e<g;e++){if(b[e]==c){a=true;break;}}if(!a&&c&&typeof c=="function"){d.registorPool[f].push(c);
}};EventDispatcher.prototype.MonkeyDispatchEvent=function(f,e){var b=this;if(b.registorPool[f.type]){var a=b.registorPool[f.type];var d=false;for(var c=0,g=a.length;
c<g;c++){f.target=b;if(e&&e==a[c]){d=true;}}if(d){e(f.data);}else{if(e&&!d){alert("未先监听"+e.getName()+"方法");}else{for(var c=0,g=a.length;c<g;c++){a[c](f.data);
}}}}};EventDispatcher.prototype.removeEventListener=function(e,b){var c=this;if(c.registorPool[e]){var a=c.registorPool[e];for(var d=0,f=a.length;d<f;d++){if(a[d]==b){a.splice(d,1);
}}}};function MonkeyEvent(a,b){this.type=a;this.data=b;this.target=null;}Function.prototype.getName=function(){return this.name||this.toString().match(/function\s*([^(]*)\(/)[1];
};var isAndroid=(function(){return/(Android)/i.test(navigator.userAgent);})();var isDom=function(a){if(typeof(a)=="object"&&a instanceof HTMLElement){return true;
}return false;};var isJQ=function(a){if(window.jQuery&&typeof(a)=="object"&&a instanceof jQuery){return true;}return false;};var isLdDom=function(b){if(typeof(b)=="object"&&b instanceof HTMLElement){var a=b.nodeName.toLowerCase();
if(a=="img"){return true;}}return false;};var isLdCompleteList=function(a){if(typeof(a)=="object"&&"sort" in a){var b=a[0];if("src" in b&&"e" in b){return true;
}}return false;};var isLdDomFormat=function(a){if(!a){return false;}return a.src&&a.type==="img"?true:false;};var getDomType=function(a){return a.nodeName.toLowerCase();
};Array.prototype.getImgList=function(){var a=[];for(val in this){var b=this[val];if("src" in b&&"e" in b){a.push(b.e);}}return a;};var MK_Loading=(function(){function b(d){for(var c in d){this[c]=d[c];
}}b.prototype.getDom=function(){return this.e||null;};b.prototype.load=function(){this.count++;this.e.src=this.src;};function a(d){var c=this;EventDispatcher.call(this);
c.p=d;c.srcNames=d.srcNames?d.srcNames:"alts";c.loadUp=typeof(d.LDup)==="function"?d.LDup:null;c.callback=typeof(d.LDsuccess)==="function"?d.LDsuccess:null;
c.list=[];c.suclist=[];c.set=null;c.timers=30;c.length=null;c.errorCount=3;c.upDate(0);if(c.p.LDpage){c.getDomList(document);return;}if(c.p.LDdom){c.addLoadObject(c.p.LDdom);
}}MK_Extend(a,EventDispatcher);a.prototype.setDomList=function(h,e){var f=this,d=[];for(var c=0,g=h.length;c<g;c++){var i=h[c].getAttribute(f.srcNames);
if(i){d.push(f.addLDstack({type:e,src:i,e:h[c]}));}}return d;};a.prototype.setAddList=function(e){var d=this,c=[];for(var g=0,f=e.length;g<f;g++){c.push(d.addLDstack(e[g]));
}return c;};a.prototype.getDomList=function(e){var d=this,c=e.getElementsByTagName("img");return d.setDomList(c,"img");};a.prototype.getJqList=function(g,e){var f=this,d=[],c=g.find("img");
return f.setDomList(c,"img");};a.prototype.addLoadObject=function(h){var f=this;if(isDom(h)){if(isLdDom(h)){return f.setDomList([h],e);}else{return f.getDomList(h);
}}else{if(isJQ(h)){if(h.length<=0){return[];}var e=getDomType(h[0]);if(e=="img"){return f.setDomList(h,e);}else{return f.getJqList(h);}}else{if(isLdDomFormat(h)){return[f.addLDstack(h)];
}else{if(typeof h.sort=="function"){var d=[];for(var c=0,g=h.length;c<g;c++){if(isLdDomFormat[c]){d.push(f.addLDstack(h));}}return d;}}}}return[];};a.prototype.init=function(){var d=this;
for(var c=0,e=d.list.length;c<e;c++){(function(g){var f=d.list[g];f.status=0;f.count=0;switch(f.type){case"img":f.e=f.e||new Image();f.e.onload=function(){f.status=1;
d.removeLD(f);};f.e.onerror=function(){if(f.count<d.errorCount){f.status=2;f.load();}else{f.status=3;d.removeLD(f);}};break;case"ajax":f.load=function(){f.count++;
f.ajaxFn();};}})(c);}};a.prototype.upDate=function(d){var c=this;if(c.loadUp){c.loadUp(d);}c.MonkeyDispatchEvent(new MonkeyEvent("update",d));};a.prototype.start=function(){var e=this;
e.init();e.length=e.getLength();e.loads();var d=0,c=function(){var f=parseInt(e.suclist.length/e.length*100);if(f<=100){if(e.p.LDtween&&d<f){d++;}else{d=f;
}e.upDate(d);if(d==100){clearInterval(e.set);if(e.callback){e.callback();}e.MonkeyDispatchEvent(new MonkeyEvent("complete",d));}}};e.set=setInterval(c,e.timers);
};a.prototype.add=function(c){var d=this;return typeof c==="object"?d.addLoadObject(c):[];};a.prototype.addLDstack=function(h){var g=this,c=g.isLoad(h.e),f;
if(c){f=c;}else{var d=new b(h);var e=g.list.push(d);f=d;}return f;};a.prototype.addImgSheet=function(){var h=this,c=arguments[0],g=[];var d=c.mask||"00";
for(var f=0,j=c.length;f<j;f+=c.step){var e=c.start+f;e=d.toString()+e;e=e.substr(e.length-d.length,d.length);g.push({type:"img",src:c.imgPrefix+e+"."+c.imgType});
}return h.setAddList(g);};a.prototype.addAjax=function(c){var d=this;d.list.push({id:Math.random(),type:"ajax",ajaxFn:function(){var e=this;c(function(g,f){if(g){if(e.count<d.errorCount){e.status=2;
e.load();}else{e.status=3;d.removeLD(e);}}else{e.status=1;d.removeLD(e);}});}});};a.prototype.isLoad=function(f){var d=this;for(var c=0,g=d.list.length;
c<g;c++){if(f&&d.list[c].e==f){return d.list[c];}}return false;};a.prototype.loads=function(){var d=this;for(var c=0,e=d.list.length;c<e;c++){d.list[c].load();
}};a.prototype.getLength=function(){var c=this;return c.list.length;};a.prototype.removeLD=function(d){var c=this;var e=0;while(e<c.list.length){if(c.list[e]==d){c.suclist.push(d);
c.list.splice(e,1);break;}e++;}};return a;}());var MK_animateImages=(function(){var f=/^-ms-/,h=/-([\da-z])/gi,e=function(i,j){return j.toUpperCase();},d=["Webkit","O","Moz","ms"];
function g(i){return i.replace(f,"ms-").replace(h,e);}function a(m,k){if(k in m){return k;}var n=k.charAt(0).toUpperCase()+k.slice(1),j=k,l=d.length;while(l--){k=d[l]+n;
if(k in m){return k;}}return j;}var c=function(j,i){if(j.runtimeStyle){if(typeof j.runtimeStyle.opacity==="undefined"){j.style.filter="alpha(opacity="+i*100+")";
}else{j.runtimeStyle.opacity=i;}}else{j.style.opacity=i;}};function b(j){EventDispatcher.call(this);var i=this;if(j.imgList.length>0){i.width=j.width?j.width:j.imgList[0].width;
i.height=j.height?j.height:j.imgList[0].height;}if(isDom(j.parents)){i.parents=j.parents;}else{if(isJQ(j.parents)){i.parents=j.parents[0];}}i.anmtList=j.imgList;
i.type=j.type?j.type:"canvas";i.step=j.step;i.times=j.times;i.ITV=null;i.startIndex=0;i.endIndex;i.progress=0;i.loop=j.loop;i.up=null;i.drawImages=function(){};
i.clear=function(){};}MK_Extend(b,EventDispatcher);b.prototype.toProgress=function(j){var i=this;i.progress=j;i.drawImages(j);};b.prototype.setStart=function(j){var i=this;
i.startIndex=j;i.toProgress(j);};b.prototype.setEnd=function(j){var i=this;if(j>i.length){i.endIndex=i.length;}else{i.endIndex=j;}};b.prototype.play=function(i){var j=this;
i=i||1;if(j.ITV||this.anmtList.length==0){return;}j.ITV=setInterval(function(){if((j.progress>=j.endIndex&&i==1)||(j.progress<j.startIndex&&i==-1)){if(j.loop){j.progress=i==1?j.startIndex:j.endIndex-1;
}else{j.progress=i==-1?j.startIndex:j.endIndex-1;j.stop();}j.MonkeyDispatchEvent(new MonkeyEvent("complete",j.progress));return;}j.toProgress(j.progress);
j.MonkeyDispatchEvent(new MonkeyEvent("update",j.progress));j.MonkeyDispatchEvent(new MonkeyEvent(j.progress,j.progress));j.progress+=j.step*i;},j.times);
};b.prototype.inverse=function(){this.play(-1);};b.prototype.stopActivity=function(){var i=this;if(i.ITV){clearInterval(i.ITV);i.ITV=null;}};b.prototype.pause=function(){var i=this;
i.stopActivity();};b.prototype.stop=function(){var i=this;i.stopActivity();};b.prototype.creatElment=function(j){var i=this;return document.createElement(j);
};b.prototype.setCssObj=function(k,j){var i=this;for(name in j){i.css(k,name,j[name]);}};b.prototype.css=function(o,n,m){var i=this;if(typeof n==="undefined"||!n){return false;
}if(typeof n==="object"){i.setCssObj(o,n);return false;}var k=g(n);var l=o.style;var j=a(l,k);if(j=="opacity"){c(o,m);return;}if(typeof m==="undefined"){if(o.style[j]!=""){return o.style[j];
}else{if(window.getComputedStyle){return window.getComputedStyle(o,null)[j];}else{if(o.currentStyle){return o.currentStyle[j];}else{return"auto";}}}}else{if(o.runtimeStyle){o.runtimeStyle[j]=m;
}else{o.style[j]=m;}}};b.prototype.remove=function(){var i=this;while(i.parents.hasChildNodes()){i.parents.removeChild(i.parents.firstChild);}};return b;
})();function MK_animateSheet(c){if(isLdCompleteList(c.imgList)){c.imgList=c.imgList.getImgList();}else{c.imgList=[];}this.length=c.imgList.length;MK_animateImages.call(this,c);
var b=this;if(b.type=="canvas"){b.canvas=b.creatElment("canvas");b.canvas.width=b.width;b.canvas.height=b.height;b.parents.appendChild(b.canvas);var a=b.canvas.getContext("2d");
b.drawImages=function(d){b.clear();a.drawImage(b.anmtList[d],0,0);};b.clear=function(){a.clearRect(0,0,b.width,b.height);};}else{if(b.type=="img"){b.drawImages=function(d){b.clear();
b.parents.appendChild(b.anmtList[d]);};b.clear=function(){while(b.parents.hasChildNodes()){b.parents.removeChild(b.parents.firstChild);}};}}b.endIndex=b.length;
b.toProgress(b.progress);}MK_Extend(MK_animateSheet,MK_animateImages);function MK_animateSprite(f){if(isDom(f.imgList)){f.imgList=[f.imgList];}else{if(isLdCompleteList(f.imgList)){f.imgList=f.imgList.getImgList();
}else{if(!isJQ(f.imgList)){f.imgList=[];}}}this.length=f.row*f.column;MK_animateImages.call(this,f);var b=this;var c=b.anmtList[0];if(!c){return;}b.getPosition=function(h){return{x:-(h%f.column*b.width),y:-(parseInt(h/f.column)*b.height)};
};if(b.type=="canvas"){b.remove();b.canvas=b.creatElment("canvas");b.canvas.width=b.width;b.canvas.height=b.height;b.parents.appendChild(b.canvas);var a=b.canvas.getContext("2d");
var d=c.width;var g=c.height;b.drawImages=function(i){b.clear();var h=b.getPosition(i);a.drawImage(c,h.x,h.y,d,g);};b.clear=function(){a.clearRect(0,0,b.width,b.height);
};}else{if(b.type=="img"){var e=b.creatElment("div");b.css(e,{position:"absolute",top:0,left:0,width:b.width+"px",height:b.height+"px",overflow:"hidden"});
b.parents.appendChild(e);e.appendChild(c);b.css(c,{position:"absolute",top:0,left:0});b.drawImages=function(i){var h=b.getPosition(i);b.css(c,{top:h.y+"px",left:h.x+"px"});
};b.clear=function(){while(b.parents.hasChildNodes()){b.parents.removeChild(b.parents.firstChild);}};}}b.endIndex=b.length;b.toProgress(b.progress);}MK_Extend(MK_animateSprite,MK_animateImages);
